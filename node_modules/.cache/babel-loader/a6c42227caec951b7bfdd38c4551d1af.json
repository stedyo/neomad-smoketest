{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.clearAllState = clearAllState;\nexports.commitServerChanges = commitServerChanges;\nexports.duplicateState = duplicateState;\nexports.enqueueTask = enqueueTask;\nexports.estimateAttribute = estimateAttribute;\nexports.estimateAttributes = estimateAttributes;\nexports.getObjectCache = getObjectCache;\nexports.getPendingOps = getPendingOps;\nexports.getServerData = getServerData;\nexports.getState = getState;\nexports.initializeState = initializeState;\nexports.mergeFirstPendingState = mergeFirstPendingState;\nexports.popPendingState = popPendingState;\nexports.pushPendingState = pushPendingState;\nexports.removeState = removeState;\nexports.setPendingOp = setPendingOp;\nexports.setServerData = setServerData;\n\nvar ObjectStateMutations = _interopRequireWildcard(require(\"./ObjectStateMutations\"));\n\nvar _TaskQueue = _interopRequireDefault(require(\"./TaskQueue\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function (nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\n\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache(nodeInterop);\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n/**\n * Copyright (c) 2015-present, Parse, LLC.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @flow\n */\n\n\nlet objectState = new WeakMap();\n\nfunction getState(obj\n/*: ParseObject*/\n)\n/*: ?State*/\n{\n  const classData = objectState.get(obj);\n  return classData || null;\n}\n\nfunction initializeState(obj\n/*: ParseObject*/\n, initial\n/*:: ?: State*/\n)\n/*: State*/\n{\n  let state = getState(obj);\n\n  if (state) {\n    return state;\n  }\n\n  if (!initial) {\n    initial = {\n      serverData: {},\n      pendingOps: [{}],\n      objectCache: {},\n      tasks: new _TaskQueue.default(),\n      existed: false\n    };\n  }\n\n  state = initial;\n  objectState.set(obj, state);\n  return state;\n}\n\nfunction removeState(obj\n/*: ParseObject*/\n)\n/*: ?State*/\n{\n  const state = getState(obj);\n\n  if (state === null) {\n    return null;\n  }\n\n  objectState.delete(obj);\n  return state;\n}\n\nfunction getServerData(obj\n/*: ParseObject*/\n)\n/*: AttributeMap*/\n{\n  const state = getState(obj);\n\n  if (state) {\n    return state.serverData;\n  }\n\n  return {};\n}\n\nfunction setServerData(obj\n/*: ParseObject*/\n, attributes\n/*: AttributeMap*/\n) {\n  const serverData = initializeState(obj).serverData;\n  ObjectStateMutations.setServerData(serverData, attributes);\n}\n\nfunction getPendingOps(obj\n/*: ParseObject*/\n)\n/*: Array<OpsMap>*/\n{\n  const state = getState(obj);\n\n  if (state) {\n    return state.pendingOps;\n  }\n\n  return [{}];\n}\n\nfunction setPendingOp(obj\n/*: ParseObject*/\n, attr\n/*: string*/\n, op\n/*: ?Op*/\n) {\n  const pendingOps = initializeState(obj).pendingOps;\n  ObjectStateMutations.setPendingOp(pendingOps, attr, op);\n}\n\nfunction pushPendingState(obj\n/*: ParseObject*/\n) {\n  const pendingOps = initializeState(obj).pendingOps;\n  ObjectStateMutations.pushPendingState(pendingOps);\n}\n\nfunction popPendingState(obj\n/*: ParseObject*/\n)\n/*: OpsMap*/\n{\n  const pendingOps = initializeState(obj).pendingOps;\n  return ObjectStateMutations.popPendingState(pendingOps);\n}\n\nfunction mergeFirstPendingState(obj\n/*: ParseObject*/\n) {\n  const pendingOps = getPendingOps(obj);\n  ObjectStateMutations.mergeFirstPendingState(pendingOps);\n}\n\nfunction getObjectCache(obj\n/*: ParseObject*/\n)\n/*: ObjectCache*/\n{\n  const state = getState(obj);\n\n  if (state) {\n    return state.objectCache;\n  }\n\n  return {};\n}\n\nfunction estimateAttribute(obj\n/*: ParseObject*/\n, attr\n/*: string*/\n)\n/*: mixed*/\n{\n  const serverData = getServerData(obj);\n  const pendingOps = getPendingOps(obj);\n  return ObjectStateMutations.estimateAttribute(serverData, pendingOps, obj.className, obj.id, attr);\n}\n\nfunction estimateAttributes(obj\n/*: ParseObject*/\n)\n/*: AttributeMap*/\n{\n  const serverData = getServerData(obj);\n  const pendingOps = getPendingOps(obj);\n  return ObjectStateMutations.estimateAttributes(serverData, pendingOps, obj.className, obj.id);\n}\n\nfunction commitServerChanges(obj\n/*: ParseObject*/\n, changes\n/*: AttributeMap*/\n) {\n  const state = initializeState(obj);\n  ObjectStateMutations.commitServerChanges(state.serverData, state.objectCache, changes);\n}\n\nfunction enqueueTask(obj\n/*: ParseObject*/\n, task\n/*: () => Promise*/\n)\n/*: Promise*/\n{\n  const state = initializeState(obj);\n  return state.tasks.enqueue(task);\n}\n\nfunction duplicateState(source\n/*: ParseObject*/\n, dest\n/*: ParseObject*/\n)\n/*: void*/\n{\n  const oldState = initializeState(source);\n  const newState = initializeState(dest);\n\n  for (const key in oldState.serverData) {\n    newState.serverData[key] = oldState.serverData[key];\n  }\n\n  for (let index = 0; index < oldState.pendingOps.length; index++) {\n    for (const key in oldState.pendingOps[index]) {\n      newState.pendingOps[index][key] = oldState.pendingOps[index][key];\n    }\n  }\n\n  for (const key in oldState.objectCache) {\n    newState.objectCache[key] = oldState.objectCache[key];\n  }\n\n  newState.existed = oldState.existed;\n}\n\nfunction clearAllState() {\n  objectState = new WeakMap();\n}","map":{"version":3,"sources":["/Users/szd/Dev/ycomms-smoketest-landing-page/node_modules/parse/lib/node/UniqueInstanceStateController.js"],"names":["Object","defineProperty","exports","value","clearAllState","commitServerChanges","duplicateState","enqueueTask","estimateAttribute","estimateAttributes","getObjectCache","getPendingOps","getServerData","getState","initializeState","mergeFirstPendingState","popPendingState","pushPendingState","removeState","setPendingOp","setServerData","ObjectStateMutations","_interopRequireWildcard","require","_TaskQueue","_interopRequireDefault","obj","__esModule","default","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","cache","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","objectState","classData","initial","state","serverData","pendingOps","objectCache","tasks","existed","delete","attributes","attr","op","className","id","changes","task","enqueue","source","dest","oldState","newState","index","length"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.clearAllState = clearAllState;\nexports.commitServerChanges = commitServerChanges;\nexports.duplicateState = duplicateState;\nexports.enqueueTask = enqueueTask;\nexports.estimateAttribute = estimateAttribute;\nexports.estimateAttributes = estimateAttributes;\nexports.getObjectCache = getObjectCache;\nexports.getPendingOps = getPendingOps;\nexports.getServerData = getServerData;\nexports.getState = getState;\nexports.initializeState = initializeState;\nexports.mergeFirstPendingState = mergeFirstPendingState;\nexports.popPendingState = popPendingState;\nexports.pushPendingState = pushPendingState;\nexports.removeState = removeState;\nexports.setPendingOp = setPendingOp;\nexports.setServerData = setServerData;\n\nvar ObjectStateMutations = _interopRequireWildcard(require(\"./ObjectStateMutations\"));\n\nvar _TaskQueue = _interopRequireDefault(require(\"./TaskQueue\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function (nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\n\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache(nodeInterop);\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n/**\n * Copyright (c) 2015-present, Parse, LLC.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @flow\n */\n\n\nlet objectState = new WeakMap();\n\nfunction getState(obj\n/*: ParseObject*/\n)\n/*: ?State*/\n{\n  const classData = objectState.get(obj);\n  return classData || null;\n}\n\nfunction initializeState(obj\n/*: ParseObject*/\n, initial\n/*:: ?: State*/\n)\n/*: State*/\n{\n  let state = getState(obj);\n\n  if (state) {\n    return state;\n  }\n\n  if (!initial) {\n    initial = {\n      serverData: {},\n      pendingOps: [{}],\n      objectCache: {},\n      tasks: new _TaskQueue.default(),\n      existed: false\n    };\n  }\n\n  state = initial;\n  objectState.set(obj, state);\n  return state;\n}\n\nfunction removeState(obj\n/*: ParseObject*/\n)\n/*: ?State*/\n{\n  const state = getState(obj);\n\n  if (state === null) {\n    return null;\n  }\n\n  objectState.delete(obj);\n  return state;\n}\n\nfunction getServerData(obj\n/*: ParseObject*/\n)\n/*: AttributeMap*/\n{\n  const state = getState(obj);\n\n  if (state) {\n    return state.serverData;\n  }\n\n  return {};\n}\n\nfunction setServerData(obj\n/*: ParseObject*/\n, attributes\n/*: AttributeMap*/\n) {\n  const serverData = initializeState(obj).serverData;\n  ObjectStateMutations.setServerData(serverData, attributes);\n}\n\nfunction getPendingOps(obj\n/*: ParseObject*/\n)\n/*: Array<OpsMap>*/\n{\n  const state = getState(obj);\n\n  if (state) {\n    return state.pendingOps;\n  }\n\n  return [{}];\n}\n\nfunction setPendingOp(obj\n/*: ParseObject*/\n, attr\n/*: string*/\n, op\n/*: ?Op*/\n) {\n  const pendingOps = initializeState(obj).pendingOps;\n  ObjectStateMutations.setPendingOp(pendingOps, attr, op);\n}\n\nfunction pushPendingState(obj\n/*: ParseObject*/\n) {\n  const pendingOps = initializeState(obj).pendingOps;\n  ObjectStateMutations.pushPendingState(pendingOps);\n}\n\nfunction popPendingState(obj\n/*: ParseObject*/\n)\n/*: OpsMap*/\n{\n  const pendingOps = initializeState(obj).pendingOps;\n  return ObjectStateMutations.popPendingState(pendingOps);\n}\n\nfunction mergeFirstPendingState(obj\n/*: ParseObject*/\n) {\n  const pendingOps = getPendingOps(obj);\n  ObjectStateMutations.mergeFirstPendingState(pendingOps);\n}\n\nfunction getObjectCache(obj\n/*: ParseObject*/\n)\n/*: ObjectCache*/\n{\n  const state = getState(obj);\n\n  if (state) {\n    return state.objectCache;\n  }\n\n  return {};\n}\n\nfunction estimateAttribute(obj\n/*: ParseObject*/\n, attr\n/*: string*/\n)\n/*: mixed*/\n{\n  const serverData = getServerData(obj);\n  const pendingOps = getPendingOps(obj);\n  return ObjectStateMutations.estimateAttribute(serverData, pendingOps, obj.className, obj.id, attr);\n}\n\nfunction estimateAttributes(obj\n/*: ParseObject*/\n)\n/*: AttributeMap*/\n{\n  const serverData = getServerData(obj);\n  const pendingOps = getPendingOps(obj);\n  return ObjectStateMutations.estimateAttributes(serverData, pendingOps, obj.className, obj.id);\n}\n\nfunction commitServerChanges(obj\n/*: ParseObject*/\n, changes\n/*: AttributeMap*/\n) {\n  const state = initializeState(obj);\n  ObjectStateMutations.commitServerChanges(state.serverData, state.objectCache, changes);\n}\n\nfunction enqueueTask(obj\n/*: ParseObject*/\n, task\n/*: () => Promise*/\n)\n/*: Promise*/\n{\n  const state = initializeState(obj);\n  return state.tasks.enqueue(task);\n}\n\nfunction duplicateState(source\n/*: ParseObject*/\n, dest\n/*: ParseObject*/\n)\n/*: void*/\n{\n  const oldState = initializeState(source);\n  const newState = initializeState(dest);\n\n  for (const key in oldState.serverData) {\n    newState.serverData[key] = oldState.serverData[key];\n  }\n\n  for (let index = 0; index < oldState.pendingOps.length; index++) {\n    for (const key in oldState.pendingOps[index]) {\n      newState.pendingOps[index][key] = oldState.pendingOps[index][key];\n    }\n  }\n\n  for (const key in oldState.objectCache) {\n    newState.objectCache[key] = oldState.objectCache[key];\n  }\n\n  newState.existed = oldState.existed;\n}\n\nfunction clearAllState() {\n  objectState = new WeakMap();\n}"]},"metadata":{},"sourceType":"script"}